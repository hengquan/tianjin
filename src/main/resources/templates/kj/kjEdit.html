<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>input</title>
<!-- 1 bootstrap基础css -->
<link href="../libs/bootstrap-3.3.7-dist/css/bootstrap.css"
	rel="stylesheet">
<!-- 2 table表格css -->
<link href="../libs/bootstrap-3.3.7-dist/css/bootstrap-table.min.css"
	rel="stylesheet">
<!-- 3 treeview树css -->
<link href="../libs/bootstrap-3.3.7-dist/css/bootstrap-treeview.min.css"
	rel="stylesheet">
<!-- 4 datetimepicker时间选择css -->
<link
	href="../libs/bootstrap-3.3.7-dist/css/bootstrap-datetimepicker.min.css"
	rel="stylesheet">
<!-- 5 select选择框css -->
<link href="../libs/bootstrap-3.3.7-dist/css/bootstrap-select.css"
	rel="stylesheet">
<!-- 6 fileinput上传文件css -->
<link href="../libs/bootstrap-3.3.7-dist/css/fileinput.min.css"
	rel="stylesheet">
<!-- 7 icheck单选+多选css -->
<link href="../libs/bootstrap-3.3.7-dist/css/icheck-blue.css"
	rel="stylesheet">
<!-- 8 Validator验证css -->
<link href="../libs/bootstrap-3.3.7-dist/css/bootstrapValidator.min.css"
	rel="stylesheet">
<!-- 9 layer弹框css -->
<link href="../libs/layer/layer-new.css" rel="stylesheet">
<!-- 10 引入字体css -->
<link href="../libs/bootstrap-3.3.7-dist/fonts/iconfont.css"
	rel="stylesheet">
<!-- 11 页面样式css -->
<link href="../src/css/pt-main.css" rel="stylesheet">

<!-- 优先引入jquery1.12.4版本 -->
<script src="../libs/jquery/jquery-1.12.4.js"></script>
<!-- 1 bootstrap基础js -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
<!-- 2 table表格js -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrap-table.min.js"></script>
<!-- 2 table列表数据js 可删除？ -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrap-table-data.js"></script>
<!-- 3 treeview树js -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrap-treeview.js"></script>
<!-- 4 datetimepicker时间选择js -->
<script
	src="../libs/bootstrap-3.3.7-dist/js/bootstrap-datetimepicker.js"></script>
<!-- 5 select选择框js -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrap-select.min.js"></script>
<!-- 6 fileinput上传文件js -->
<script src="../libs/bootstrap-3.3.7-dist/js/fileinput.min.js"></script>
<!-- 6 fileinput中文包js -->
<script src="../libs/bootstrap-3.3.7-dist/js/fileinput_locale_zh.js"></script>
<!-- 7 icheck单选+多选js -->
<script src="../libs/bootstrap-3.3.7-dist/js/icheck.min.js"></script>
<!-- 8 Validator验证js -->
<script src="../libs/bootstrap-3.3.7-dist/js/bootstrapValidator.min.js"></script>
<!-- 9 layer弹框js -->
<script src="../libs/layer/layer.js"></script>
<!-- 11 页面js -->
<script src="../src/js/main.js"></script>

</head>
<body>
	<br>
	<br>
	<br>
	<div class="container">
		<div class="row clearfix">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 column">
				<form class="form-horizontal pt-form-full" role="form" id="form">
				  <input type="hidden" name="id" id="kjId">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label class="col-lg-1 col-md-1 col-sm-1 col-xs-6" for="title"><span>
									※ </span>课件名称</label>
							<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<input type="text" class="form-control" name="kjName" id="kjName" />
							</div>
						</div>
					</div>
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label class="col-lg-1 col-md-1 col-sm-1 col-xs-6" for="dingjia"><span>
									※ </span>选择分类</label>
							<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<select id="kjCatNames" name="kjCatNames" class="selectpicker"
									data-live-search="true" title="请选择">
									<option>政府指导价</option>
									<option>政府定价</option>
									<option>市场调节价</option>
								</select>
							</div>
						</div>
					</div>
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label class="col-lg-1 col-md-1 col-sm-1 col-xs-6" for="biaozhun"><span
								class="cfff"> ※ </span>过期时间</label>
							<div class="date datetimepicker col-lg-6 col-md-6 col-sm-6 col-xs-6"
								data-date="12-02-2012" data-date-format="dd-mm-yyyy">
								<input class="form-control" name="expireDate" id="expireDate" size="16"
									type="text" value=""> <span class="add-on"><i
									class="icon-th"></i></span>
							</div>
						</div>
					</div>
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label class="col-lg-1 col-md-1 col-sm-1 col-xs-6" for="title"><span>
									※ </span>学分</label>
							<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<input type="text" class="form-control" name="score" id="score" />
							</div>
						</div>
					</div>

					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
						<div class="form-group">
							<label class="col-lg-1 col-md-1 col-sm-1 col-xs-6" for="biaozhun"><span>
									※ </span>说明</label>
							<div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
								<textarea id="remarks" class="form-control" name="remarks"
									style="min-height: 108px"></textarea>
							</div>
						</div>
					</div>
					<div class="form-group pt-btn-submit-layer">
						<button onclick="updateMnsc()"
							class="btn w160 btn-lg btn-default btn-primary">保存</button>
						<button class="btn w160 btn-lg btn-default btn-default">取消</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<br>
	<br>
	<br>
	<script>
    $(function() {
      var url = location.search;
      if(url != ''){
        url = url.substr(1);
        var split = url.split("=");
        $.ajax({
          type : 'post',
          url : "/kj/get",
          data : {"id":split[1]},
          dataType : 'json',
          cache : false,
          success : function(data) {
            var kj = data.data;
            $("#kjId").val(kj.id);
            $("#kjName").val(kj.kjName);
            $("#kjCatNames").val(kj.kjCatNames);
            $("#expireDate").val(kj.expireDate);
            $("#score").val(kj.score);
            $("#remarks").val(kj.remarks);
          },
          error : function() { //失败回调函数
            alert("获取信息失败");
          }
        });
      }
    });

    function updateMnsc() {
      alert($("#form").serialize());
      $.ajax({
        type : 'post',
        url : "/kj/update",
        data : $("#form").serialize(),
        dataType : 'json',
        cache : false,
        success : function(data) {
          alert("成功");
          closeMy();
          parent.refresh();
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) { //失败回调函数
          var m="系统错误：\nstatu=" + XMLHttpRequest.status + "\nreadyState=" + XMLHttpRequest.readyState + "\ntext=" + textStatus + "\nerrThrown=" + errorThrown;
          alert(m);
        }
      });
    }
    function closeMy() {
      var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
      parent.layer.close(index); //再执行关闭
    }
  </script>
</body>
</html>